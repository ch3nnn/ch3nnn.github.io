

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Filebeatè½»é‡å‹æ—¥å¿—é‡‡é›†å™¨-è‡ªå®šä¹‰processorså¤„ç†å™¨ [ Ch3nnnä¸ªäººåšå®¢ ]</title>

  <link rel="icon" href="/img/favicon.ico">


    <meta name="author" content="Ch3nnn">


    <meta name="subtitle" content="Ch3nnn ä¸ªäººåšå®¢ | æŠ˜è…¾ä¸æ¯ Â· ä¹æ­¤ä¸ç–².">


    <meta name="Description" content="å°ç«™ä¸»è¦ç”¨æ¥åˆ†äº«å’Œè®°å½•å­¦ä¹ ç»éªŒ,æ•™ç¨‹,è®°å½•ä¸ªäººç”Ÿæ´»çš„ç‚¹æ»´ä»¥åŠä¸€äº›éšç¬”.">


    <meta name="keywords" content=",linux, nginx, mysql, æœåŠ¡å™¨, ubuntu, shell, web, mac, python, django, es">


  <link rel="alternate" href="/feed.xml " title="Ch3nnnä¸ªäººåšå®¢" type="application/atom+xml">


  
    <link rel="stylesheet" href="/css/main.css">
  


<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

<meta name="generator" content="Hexo 6.3.0"></head>
  <body data-theme="light" class="notransition">
    <script>
      const body = document.body;
      const data = body.getAttribute("data-theme");
      const initTheme = (state) => {
        if (state === "dark") {
          body.setAttribute("data-theme", "dark");
        } else if (state === "light") {
          body.removeAttribute("data-theme");
        } else {
          localStorage.setItem("theme", data);
        }
      };
   
      initTheme(localStorage.getItem("theme"));
      
      setTimeout(() => body.classList.remove("notransition"), 75);
    </script>
  <div class="navbar" role="navigation">
    <nav class="menu">
      <input type="checkbox" id="menu-trigger" class="menu-trigger" />
      <label for="menu-trigger">
        <span class="menu-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 512 512"
          >
            <path
              d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
            />
          </svg>
        </span>
      </label>
      <a id="mode">
        <svg
          class="mode-sunny"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>LIGHT</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
        <svg
          class="mode-moon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>DARK</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
      </a>
      <div class="trigger">
        <div class="trigger-container">
          
            
            
            
            
            
            
            <a class="menu-link " href="/"> Home ğŸ </a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/about/"> About ğŸ‘¨â€ğŸ’»</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/archives/"> Archives ğŸ“†</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/tags/"> Tags ğŸ·ï¸</a>
          
              <a class="menu-link" href="/feed.xml"><svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg></a>
        </div>
      </div>
    </nav>
  </div>

  
<div class="wrapper post">
  <main class="page-content" aria-label="Content">
      <header class="header">
        
          <div class="tags">
            <a href="/tags/Go/" class="tag"># Go</a>
          </div>
        
        <h1 class="header-title" itemprop="headline">Filebeatè½»é‡å‹æ—¥å¿—é‡‡é›†å™¨-è‡ªå®šä¹‰processorså¤„ç†å™¨</h1>
          <div class="post-meta">
            <time>2æœˆ 23, 2023</time>
            <span itemprop="author">
              <span itemprop="name">Ch3nnn</span>
            </span>
          </div>
        </header>

          <div class="page-content"><h2 id="å¼•å…¥å¯¹beatçš„ä¾èµ–"><a href="#å¼•å…¥å¯¹beatçš„ä¾èµ–" class="headerlink" title="å¼•å…¥å¯¹beatçš„ä¾èµ–"></a>å¼•å…¥å¯¹beatçš„ä¾èµ–</h2><p><code>go get github.com/elastic/beats/v7</code></p>
<h2 id="å®šä¹‰åœ¨filebeatä¸­çš„é…ç½®æ–‡ä»¶"><a href="#å®šä¹‰åœ¨filebeatä¸­çš„é…ç½®æ–‡ä»¶" class="headerlink" title="å®šä¹‰åœ¨filebeatä¸­çš„é…ç½®æ–‡ä»¶"></a>å®šä¹‰åœ¨filebeatä¸­çš„é…ç½®æ–‡ä»¶</h2><p>filebeaté€šå¸¸ä»¥é…ç½®æ–‡ä»¶çš„æ–¹å¼åŠ è½½æ’ä»¶ã€‚è®©å®šä¹‰ä¸€ä¸‹è‡ªå®šä¹‰é…ç½®ã€‚</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">filebeat.inputs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">type:</span> <span class="string">log</span></span><br><span class="line">    <span class="attr">paths:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">example/example.log</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">processors:</span></span><br><span class="line">  <span class="comment"># è‡ªå®šä¹‰å¤„ç†å™¨æ’ä»¶  </span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">parse_text:</span></span><br><span class="line">      <span class="attr">file_has_suffix:</span> <span class="string">example.log</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">output.console:</span></span><br><span class="line">  <span class="attr">pretty:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="goæ–‡ä»¶ä¸­çš„é…ç½®"><a href="#goæ–‡ä»¶ä¸­çš„é…ç½®" class="headerlink" title="goæ–‡ä»¶ä¸­çš„é…ç½®"></a>goæ–‡ä»¶ä¸­çš„é…ç½®</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> actions</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> config <span class="keyword">struct</span> &#123;</span><br><span class="line">	FileHasSuffix <span class="type">string</span> <span class="string">`config:&quot;file_has_suffix&quot; validate:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åˆå§‹åŒ–åŠ è½½æ’ä»¶"><a href="#åˆå§‹åŒ–åŠ è½½æ’ä»¶" class="headerlink" title="åˆå§‹åŒ–åŠ è½½æ’ä»¶"></a>åˆå§‹åŒ–åŠ è½½æ’ä»¶</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	processors.RegisterPlugin(<span class="string">&quot;parse_text&quot;</span>,</span><br><span class="line">		checks.ConfigChecked(NewParseText,</span><br><span class="line">			checks.RequireFields(<span class="string">&quot;file_has_suffix&quot;</span>)),</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Runæ¥å£"><a href="#Runæ¥å£" class="headerlink" title="Runæ¥å£"></a>Runæ¥å£</h2><p>å¤„ç† <strong>filebeat</strong> è¯»å–åˆ°çš„æ¯è¡Œæ—¥å¿—æ•°æ®<code>message</code>, è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰ä¸€äº›å¤„ç†è§£æé€»è¾‘, ä¸‹é¢é€»è¾‘æ˜¯å°†æ—¥å¿—æ•°æ®æŒ‰<code>,</code>åˆ‡åˆ†,é‡æ–°ç»„è£…åˆ°<code>event.Fields</code>å­—æ®µé‡Œ.</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p parseText)</span></span> Run(event *beat.Event) (*beat.Event, <span class="type">error</span>) &#123;</span><br><span class="line">	<span class="keyword">if</span> !p.isParseFile(event) &#123;</span><br><span class="line">		<span class="keyword">return</span> event, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	message, err := p.getMessage(event)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> event, <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// æŒ‰ç©ºæ ¼åˆ‡åˆ†æ–‡æœ¬</span></span><br><span class="line">	split := strings.Split(message, <span class="string">&quot;,&quot;</span>)</span><br><span class="line">	p.result[<span class="string">&quot;split&quot;</span>] = split</span><br><span class="line">	_, err = event.Fields.Put(<span class="string">&quot;parse_text&quot;</span>, p.result)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> event, <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mainå‡½æ•°"><a href="#mainå‡½æ•°" class="headerlink" title="mainå‡½æ•°"></a>mainå‡½æ•°</h2><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;os&quot;</span></span><br><span class="line"></span><br><span class="line">	_ <span class="string">&quot;filebeat-plugin/pkg/processors/actions&quot;</span>  <span class="comment">// è¿™é‡Œéœ€è¦å°†è‡ªå®šä¹‰æ’ä»¶æ³¨å†Œ</span></span><br><span class="line">	<span class="string">&quot;github.com/elastic/beats/v7/filebeat/cmd&quot;</span></span><br><span class="line">	inputs <span class="string">&quot;github.com/elastic/beats/v7/filebeat/input/default-inputs&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> err := cmd.Filebeat(inputs.Init, cmd.FilebeatSettings()).Execute(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		os.Exit(<span class="number">1</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ‰“åŒ…-build"><a href="#æ‰“åŒ…-build" class="headerlink" title="æ‰“åŒ… build"></a>æ‰“åŒ… build</h2><p>é¡¹ç›®è·¯å¾„ä¸‹æ‰§è¡Œ <code>go build -o filebeat.exe  ./cmd/filebeat/</code></p>
<h2 id="è§£æç»“æœåŠæºæ—¥å¿—"><a href="#è§£æç»“æœåŠæºæ—¥å¿—" class="headerlink" title="è§£æç»“æœåŠæºæ—¥å¿—"></a>è§£æç»“æœåŠæºæ—¥å¿—</h2><p>æºæ—¥å¿—å¦‚ä¸‹:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">I,am,Bat,I</span><br></pre></td></tr></table></figure>
<p>è§£æå <code>parse_text</code> å­—æ®µæ•°æ®å¦‚ä¸‹:</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="attr">&quot;parse_text&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;split&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;I&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;am&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;Bat&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="string">&quot;I&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure>
<p>å®Œæ•´è§£æç»“æœå¦‚ä¸‹:</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;@timestamp&quot;: &quot;2023-02-23T10:26:05.154Z&quot;,</span><br><span class="line">  &quot;@metadata&quot;: &#123;</span><br><span class="line">    &quot;beat&quot;: &quot;filebeat&quot;,</span><br><span class="line">    &quot;type&quot;: &quot;_doc&quot;,</span><br><span class="line">    &quot;version&quot;: &quot;7.13.4&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;host&quot;: &#123;</span><br><span class="line">    &quot;name&quot;: &quot;chentong.local&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;agent&quot;: &#123;</span><br><span class="line">    &quot;version&quot;: &quot;7.13.4&quot;,</span><br><span class="line">    &quot;hostname&quot;: &quot;chentong.local&quot;,</span><br><span class="line">    &quot;ephemeral_id&quot;: &quot;02d53454-19dc-4fff-9182-8f04a402e399&quot;,</span><br><span class="line">    &quot;id&quot;: &quot;f10cf835-535b-4714-8bc4-1c0b3636ae1d&quot;,</span><br><span class="line">    &quot;name&quot;: &quot;chentong.local&quot;,</span><br><span class="line">    &quot;type&quot;: &quot;filebeat&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;ecs&quot;: &#123;</span><br><span class="line">    &quot;version&quot;: &quot;1.8.0&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;parse_text&quot;: &#123;</span><br><span class="line">    &quot;split&quot;: [</span><br><span class="line">      &quot;I&quot;,</span><br><span class="line">      &quot;am&quot;,</span><br><span class="line">      &quot;Bat&quot;,</span><br><span class="line">      &quot;I&quot;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;log&quot;: &#123;</span><br><span class="line">    &quot;offset&quot;: 187,</span><br><span class="line">    &quot;file&quot;: &#123;</span><br><span class="line">      &quot;path&quot;: &quot;filebeat-plugin/example/example.log&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;message&quot;: &quot;I,am,Bat,I&quot;,</span><br><span class="line">  &quot;input&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &quot;log&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p><a target="_blank" rel="noopener" href="https://github.com/ch3nnn/filebeat-plugin">https://github.com/ch3nnn/filebeat-plugin</a></p>
</div>
          <nav class="post-nav">
    
    
    <a class="post-nav-item post-nav-next" href="/2023/02/15/Golang-%E6%95%B0%E7%BB%84%E4%B8%8E%E5%88%87%E7%89%87%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E5%8F%8A%E9%99%B7%E9%98%B1/">
      <div class="nav-arrow">OLDER&nbsp;&gt;</div>
      <span class="post-title">Golang-æ•°ç»„ä¸åˆ‡ç‰‡å¸¸è§é”™è¯¯åŠé™·é˜±</span>
    </a>
    
  </nav>
          <div class="dis">
    
        <div class="btn" id="comments-btn">ç»™æˆ‘ç•™è¨€</div>
      
     
    <script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
    <div id="waline"></div>
    <script>
        window.onload = function () {
            var loadWaline = function () {
                new Waline({
                el: '#waline',
                path: location.pathname,
                avatarCDN: '',
                serverURL: 'comment-vercel.ch3nnn.cn',
                avatar: 'monsterid',
                placeholder: "Let me know what you thinkï¼"
            });
            }
            if (true) {
                document.getElementById("comments-btn").onclick=function(){
                    document.getElementById("comments-btn").style.display="none";
                    loadWaline();
		    }} else {
            loadWaline();
            }
        };
    </script>


  </div>

   </main>
</div>

  <footer class="footer">
    <small class="footer_copyright">
      <div id="bottom-inner">
        Â© 2021 Site by Ch3nnn using
        <a target="_blank" rel="noopener" href="http://hexo.io">Hexo Blog Framework</a>.
        <br>
        <span> Theme is <a target="_blank" rel="noopener" href="https://github.com/dewjohn/hexo-theme-klise">Klise</a></span>
        |
        <span id="busuanzi_container_site_pv">
          Total view <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> times
        </span>
      </div>
      <!-- å¤‡æ¡ˆä¸»ä½“-->
      <a href="https://beian.miit.gov.cn/" rel="nofollow" target="_blank">
            <p style=" height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">
                äº¬ICPå¤‡19017311å·
            </p>
        </a>
    </small>
  </footer>

  

    
      <script src="/js/main.js"></script>
    
  
  <script>
    window.FPConfig = {
      delay: 0,
      ignoreKeywords: [],
      maxRPS: 3,
      hoverDelay: 50,
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>
  <!-- ä¸è’œå­è®¡æ•°å™¨ http://busuanzi.ibruce.info/  -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</body>
</html>
