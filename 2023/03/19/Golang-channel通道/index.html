

<!DOCTYPE html>
<html lang="zh-CN">
<head>
  


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Golang-channelé€šé“ [ Ch3nnnä¸ªäººåšå®¢ ]</title>

  <link rel="icon" href="/img/favicon.ico">


    <meta name="author" content="Ch3nnn">


    <meta name="subtitle" content="Ch3nnn ä¸ªäººåšå®¢ | æŠ˜è…¾ä¸æ¯ Â· ä¹æ­¤ä¸ç–².">


    <meta name="Description" content="å°ç«™ä¸»è¦ç”¨æ¥åˆ†äº«å’Œè®°å½•å­¦ä¹ ç»éªŒ,æ•™ç¨‹,è®°å½•ä¸ªäººç”Ÿæ´»çš„ç‚¹æ»´ä»¥åŠä¸€äº›éšç¬”.">


    <meta name="keywords" content=",linux, nginx, mysql, æœåŠ¡å™¨, ubuntu, shell, web, mac, python, django, es">


  <link rel="alternate" href="/feed.xml " title="Ch3nnnä¸ªäººåšå®¢" type="application/atom+xml">


  
    <link rel="stylesheet" href="/css/main.css">
  


<link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">

<meta name="generator" content="Hexo 6.3.0"></head>
  <body data-theme="light" class="notransition">
    <script>
      const body = document.body;
      const data = body.getAttribute("data-theme");
      const initTheme = (state) => {
        if (state === "dark") {
          body.setAttribute("data-theme", "dark");
        } else if (state === "light") {
          body.removeAttribute("data-theme");
        } else {
          localStorage.setItem("theme", data);
        }
      };
   
      initTheme(localStorage.getItem("theme"));
      
      setTimeout(() => body.classList.remove("notransition"), 75);
    </script>
  <div class="navbar" role="navigation">
    <nav class="menu">
      <input type="checkbox" id="menu-trigger" class="menu-trigger" />
      <label for="menu-trigger">
        <span class="menu-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 512 512"
          >
            <path
              d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
            />
          </svg>
        </span>
      </label>
      <a id="mode">
        <svg
          class="mode-sunny"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>LIGHT</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
        <svg
          class="mode-moon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>DARK</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
      </a>
      <div class="trigger">
        <div class="trigger-container">
          
            
            
            
            
            
            
            <a class="menu-link " href="/"> Home ğŸ </a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/about/"> About ğŸ‘¨â€ğŸ’»</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/archives/"> Archives ğŸ“†</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/tags/"> Tags ğŸ·ï¸</a>
          
              <a class="menu-link" href="/feed.xml"><svg
            xmlns="http://www.w3.org/2000/svg"
            width="17"
            height="17"
            viewBox="0 0 512 512"
            fill="#ED812E"
          >
            <title>RSS</title>
            <path
              d="M108.56,342.78a60.34,60.34,0,1,0,60.56,60.44A60.63,60.63,0,0,0,108.56,342.78Z"
            />
            <path
              d="M48,186.67v86.55c52,0,101.94,15.39,138.67,52.11s52,86.56,52,138.67h86.66C325.33,312.44,199.67,186.67,48,186.67Z"
            />
            <path
              d="M48,48v86.56c185.25,0,329.22,144.08,329.22,329.44H464C464,234.66,277.67,48,48,48Z"
            />
          </svg></a>
        </div>
      </div>
    </nav>
  </div>

  
<div class="wrapper post">
  <main class="page-content" aria-label="Content">
      <header class="header">
        
          <div class="tags">
            <a href="/tags/Go/" class="tag"># Go</a>
          </div>
        
        <h1 class="header-title" itemprop="headline">Golang-channelé€šé“</h1>
          <div class="post-meta">
            <time>3æœˆ 19, 2023</time>
            <span itemprop="author">
              <span itemprop="name">Ch3nnn</span>
            </span>
          </div>
        </header>

          <div class="page-content"><blockquote>
<p>goroutine å’Œ channel (é€šé“)å¹¶æˆä¸º Go å¹¶å‘çš„ä¸¤å¤§åŸºçŸ³ã€‚channel å¯ä»¥æ”¾å¿ƒåœ°åœ¨å¤šä¸ª goroutine ä¹‹é—´ä½¿ç”¨, å› ä¸ºå®ƒæ˜¯å¹¶å‘å®‰å…¨çš„ã€‚</p>
</blockquote>
<h2 id="channel-æœ‰å“ªäº›åº”ç”¨"><a href="#channel-æœ‰å“ªäº›åº”ç”¨" class="headerlink" title="channel æœ‰å“ªäº›åº”ç”¨"></a>channel æœ‰å“ªäº›åº”ç”¨</h2><p><strong>åœæ­¢ä¿¡å·</strong><br>channel ç”¨äºåœæ­¢ä¿¡å·çš„åœºæ™¯å¾ˆå¤šï¼Œé€šå¸¸æ˜¯é€šè¿‡å…³é—­æŸä¸ªchannel æˆ–è€…å‘ channel å‘é€ä¸€ä¸ªå…ƒç´ ï¼Œä½¿å¾—æ¥æ”¶ channel çš„é‚£ä¸€æ–¹è·çŸ¥é“æ­¤ä¿¡æ¯ï¼Œè¿›è€Œåšä¸€äº›å…¶ä»–çš„æ“ä½œï¼Œå¦‚åœæ­¢æŸä¸ªå¾ªç¯ç­‰ã€‚</p>
<p><strong>å®šæ—¶ä»»åŠ¡</strong><br>ä¸è®¡æ—¶å™¨ç»“åˆï¼Œä¸€èˆ¬æœ‰ä¸¤ç§åšæ³•ï¼šå®ç°è¶…æ—¶æ§åˆ¶ã€å®ç°å®šæœŸæ‰§è¡ŒæŸä¸ªä»»åŠ¡ã€‚<br>æœ‰æ—¶å€™ï¼Œéœ€è¦æ‰§è¡ŒæŸé¡¹æ“ä½œï¼Œä½†åˆä¸æƒ³å®ƒè€—è´¹å¤ªé•¿æ—¶é—´ï¼Œä¸Šä¸€ä¸ªå®šæ—¶å™¨å°±å¯ä»¥æå®šã€‚è¿™å°±æ˜¯æ—¶æ§åˆ¶ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> &lt;- time.After(<span class="number">100</span>*time.Millisecond):</span><br><span class="line">	<span class="keyword">case</span> &lt;- s.stopc:</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç­‰å¾… 100 ms åï¼Œå¦‚æœ s.stopc è¿˜æ²¡æœ‰è¯»å‡ºæ•°æ®æˆ–è€…è¢«å…³é—­ï¼Œå°±ç›´æ¥ç»“æŸã€‚</p>
<p>å®šæ—¶æ‰§è¡ŒæŸä¸ªä»»åŠ¡ï¼Œä¹Ÿæ¯”è¾ƒç®€å•ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ticker := time.Tick(<span class="number">1</span> * time.Second)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="keyword">case</span> &lt;- ticker:</span><br><span class="line">			<span class="comment">// æ‰§è¡Œå®šæ—¶ä»»åŠ¡</span></span><br><span class="line">			fmt.Println(<span class="string">&quot;æ‰§è¡Œ 1s å®šæ—¶ä»»åŠ¡&quot;</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¯éš” 1 ç§’ç§ï¼Œæ‰§è¡Œä¸€æ¬¡å®šæ—¶ä»»åŠ¡ã€‚</p>
<p><strong>è§£è€¦ç”Ÿäº§æ–¹å’Œæ¶ˆè´¹æ–¹</strong><br>æœåŠ¡å¯åŠ¨æ—¶ï¼Œå¯åŠ¨ n ä¸ª workerï¼Œä½œä¸ºå·¥ä½œåç¨‹æ± ï¼Œè¿™äº›åç¨‹å·¥ä½œåœ¨ä¸€ä¸ª for {} æ— é™å¾ªç¯é‡Œï¼Œä»æŸä¸ª channel æ¶ˆè´¹å·¥ä½œä»»åŠ¡å¹¶æ‰§è¡Œï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	taskCh := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">	<span class="keyword">go</span> worker(taskCh)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¡ä»»åŠ¡</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		taskCh &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç­‰å¾… 1 å°æ—¶ </span></span><br><span class="line">	<span class="keyword">select</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> &lt;-time.After(time.Hour):</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">worker</span><span class="params">(taskCh &lt;-<span class="keyword">chan</span> <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">const</span> N = <span class="number">5</span></span><br><span class="line">	<span class="comment">// å¯åŠ¨ 5 ä¸ªå·¥ä½œåç¨‹</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; N; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">int</span>)</span></span> &#123;</span><br><span class="line">			<span class="keyword">for</span> &#123;</span><br><span class="line">				task := &lt;- taskCh</span><br><span class="line">				fmt.Printf(<span class="string">&quot;finish task: %d by worker %d\n&quot;</span>, task, id)</span><br><span class="line">				time.Sleep(time.Second)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;(i)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>5 ä¸ªå·¥ä½œåç¨‹åœ¨ä¸æ–­åœ°ä»å·¥ä½œé˜Ÿåˆ—é‡Œå–ä»»åŠ¡ï¼Œç”Ÿäº§æ–¹åªç®¡å¾€ channel å‘é€ä»»åŠ¡å³å¯ï¼Œè§£è€¦ç”Ÿäº§æ–¹å’Œæ¶ˆè´¹æ–¹ã€‚<br>ç¨‹åºè¾“å‡ºï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">finish task: 1 by worker 4</span><br><span class="line">finish task: 2 by worker 2</span><br><span class="line">finish task: 4 by worker 3</span><br><span class="line">finish task: 3 by worker 1</span><br><span class="line">finish task: 0 by worker 0</span><br><span class="line">finish task: 6 by worker 0</span><br><span class="line">finish task: 8 by worker 3</span><br><span class="line">finish task: 9 by worker 1</span><br><span class="line">finish task: 7 by worker 4</span><br><span class="line">finish task: 5 by worker 2</span><br></pre></td></tr></table></figure>

<p><strong>æ§åˆ¶å¹¶å‘æ•°</strong><br>æœ‰æ—¶éœ€è¦å®šæ—¶æ‰§è¡Œå‡ ç™¾ä¸ªä»»åŠ¡ï¼Œä¾‹å¦‚æ¯å¤©å®šæ—¶æŒ‰åŸå¸‚æ¥æ‰§è¡Œä¸€äº›ç¦»çº¿è®¡ç®—çš„ä»»åŠ¡ã€‚ä½†æ˜¯å¹¶å‘æ•°åˆä¸èƒ½å¤ªé«˜ï¼Œå› ä¸ºä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¾èµ–ç¬¬ä¸‰æ–¹çš„ä¸€äº›èµ„æºï¼Œå¯¹è¯·æ±‚çš„é€Ÿç‡æœ‰é™åˆ¶ã€‚è¿™æ—¶å°±å¯ä»¥é€šè¿‡ channel æ¥æ§åˆ¶å¹¶å‘æ•°ã€‚<br>channel æ¥æ§åˆ¶å¹¶å‘æ•°ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> limit = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// â€¦â€¦â€¦â€¦</span></span><br><span class="line">    <span class="keyword">for</span> _, w := <span class="keyword">range</span> work &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            limit &lt;- <span class="number">1</span></span><br><span class="line">            w()</span><br><span class="line">            &lt;-limit</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// â€¦â€¦â€¦â€¦</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ„å»ºä¸€ä¸ªç¼“å†²å‹çš„ channelï¼Œå®¹é‡ä¸º 3ã€‚æ¥ç€éå†ä»»åŠ¡åˆ—è¡¨ï¼Œæ¯ä¸ªä»»åŠ¡å¯åŠ¨ä¸€ä¸ª goroutine å»å®Œæˆã€‚çœŸæ­£æ‰§è¡Œä»»åŠ¡ï¼Œè®¿é—®ç¬¬ä¸‰æ–¹çš„åŠ¨ä½œåœ¨ w() ä¸­å®Œæˆï¼Œåœ¨æ‰§è¡Œ w() ä¹‹å‰ï¼Œå…ˆè¦ä» limit ä¸­æ‹¿â€œè®¸å¯è¯â€ï¼Œæ‹¿åˆ°è®¸å¯è¯ä¹‹åï¼Œæ‰èƒ½æ‰§è¡Œ w()ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œå®Œä»»åŠ¡ï¼Œè¦å°†â€œè®¸å¯è¯â€å½’è¿˜ã€‚è¿™æ ·å°±å¯ä»¥æ§åˆ¶åŒæ—¶è¿è¡Œçš„ goroutine æ•°ã€‚</p>
<h3 id="channel-æ•°æ®ç»“æ„"><a href="#channel-æ•°æ®ç»“æ„" class="headerlink" title="channel æ•°æ®ç»“æ„"></a>channel æ•°æ®ç»“æ„</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> hchan <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">// chan é‡Œå…ƒç´ æ•°é‡</span></span><br><span class="line">	qcount   <span class="type">uint</span></span><br><span class="line">	<span class="comment">// chan åº•å±‚å¾ªç¯æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">	dataqsiz <span class="type">uint</span></span><br><span class="line">	<span class="comment">// æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„çš„æŒ‡é’ˆ</span></span><br><span class="line">	<span class="comment">// åªé’ˆå¯¹æœ‰ç¼“å†²çš„ channel</span></span><br><span class="line">	buf      unsafe.Pointer</span><br><span class="line">	<span class="comment">// chan ä¸­å…ƒç´ å¤§å°</span></span><br><span class="line">	elemsize <span class="type">uint16</span></span><br><span class="line">	<span class="comment">// chan æ˜¯å¦è¢«å…³é—­çš„æ ‡å¿—</span></span><br><span class="line">	closed   <span class="type">uint32</span></span><br><span class="line">	<span class="comment">// chan ä¸­å…ƒç´ ç±»å‹</span></span><br><span class="line">	elemtype *_type <span class="comment">// element type</span></span><br><span class="line">	<span class="comment">// å·²å‘é€å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼•</span></span><br><span class="line">	sendx    <span class="type">uint</span>   <span class="comment">// send index</span></span><br><span class="line">	<span class="comment">// å·²æ¥æ”¶å…ƒç´ åœ¨å¾ªç¯æ•°ç»„ä¸­çš„ç´¢å¼•</span></span><br><span class="line">	recvx    <span class="type">uint</span>   <span class="comment">// receive index</span></span><br><span class="line">	<span class="comment">// ç­‰å¾…æ¥æ”¶çš„ goroutine é˜Ÿåˆ—</span></span><br><span class="line">	recvq    waitq  <span class="comment">// list of recv waiters</span></span><br><span class="line">	<span class="comment">// ç­‰å¾…å‘é€çš„ goroutine é˜Ÿåˆ—</span></span><br><span class="line">	sendq    waitq  <span class="comment">// list of send waiters</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä¿æŠ¤ hchan ä¸­æ‰€æœ‰å­—æ®µ</span></span><br><span class="line">	lock mutex</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…³äºå­—æ®µçš„å«ä¹‰éƒ½å†™åœ¨æ³¨é‡Šé‡Œäº†ï¼Œå†æ¥é‡ç‚¹è¯´å‡ ä¸ªå­—æ®µï¼š</p>
<p>buf æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„ï¼Œåªæœ‰ç¼“å†²å‹çš„ channel æ‰æœ‰ã€‚</p>
<p>sendxï¼Œrecvx å‡æŒ‡å‘åº•å±‚å¾ªç¯æ•°ç»„ï¼Œè¡¨ç¤ºå½“å‰å¯ä»¥å‘é€å’Œæ¥æ”¶çš„å…ƒç´ ä½ç½®ç´¢å¼•å€¼ï¼ˆç›¸å¯¹äºåº•å±‚æ•°ç»„ï¼‰ã€‚</p>
<p>sendqï¼Œrecvq åˆ†åˆ«è¡¨ç¤ºè¢«é˜»å¡çš„ goroutineï¼Œè¿™äº› goroutine ç”±äºå°è¯•è¯»å– channel æˆ–å‘ channel å‘é€æ•°æ®è€Œè¢«é˜»å¡ã€‚</p>
<p>waitq æ˜¯ sudog çš„ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œè€Œ sudog å®é™…ä¸Šæ˜¯å¯¹ goroutine çš„ä¸€ä¸ªå°è£…ï¼š</p>
<pre><code>type waitq struct &#123;
    first *sudog
    last  *sudog
&#125;
</code></pre>
<p>lock ç”¨æ¥ä¿è¯æ¯ä¸ªè¯» channel æˆ–å†™ channel çš„æ“ä½œéƒ½æ˜¯åŸå­çš„ã€‚</p>
<h2 id="æ”¶å‘æ•°æ®çš„æœ¬è´¨"><a href="#æ”¶å‘æ•°æ®çš„æœ¬è´¨" class="headerlink" title="æ”¶å‘æ•°æ®çš„æœ¬è´¨"></a>æ”¶å‘æ•°æ®çš„æœ¬è´¨</h2><blockquote>
<p>All transfer of value on the go channels happens with the copy of value.</p>
</blockquote>
<p>å°±æ˜¯è¯´ channel çš„å‘é€å’Œæ¥æ”¶æ“ä½œæœ¬è´¨ä¸Šéƒ½æ˜¯ â€œå€¼çš„æ‹·è´â€ï¼Œæ— è®ºæ˜¯ä» sender goroutine çš„æ ˆåˆ° chan bufï¼Œè¿˜æ˜¯ä» chan buf åˆ° receiver goroutineï¼Œæˆ–è€…æ˜¯ç›´æ¥ä» sender goroutine åˆ° receiver goroutineã€‚<br>ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="keyword">type</span> user <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="type">string</span></span><br><span class="line">	age <span class="type">int8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> u = user&#123;name: <span class="string">&quot;Ankur&quot;</span>, age: <span class="number">25</span>&#125;</span><br><span class="line"><span class="keyword">var</span> g = &amp;u</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">modifyUser</span><span class="params">(pu *user)</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">&quot;modifyUser Received Vaule&quot;</span>, pu)</span><br><span class="line">	pu.name = <span class="string">&quot;Anand&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">printUser</span><span class="params">(u &lt;-<span class="keyword">chan</span> *user)</span></span> &#123;</span><br><span class="line">	time.Sleep(<span class="number">2</span> * time.Second)</span><br><span class="line">	fmt.Println(<span class="string">&quot;printUser goRoutine called&quot;</span>, &lt;-u)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c := <span class="built_in">make</span>(<span class="keyword">chan</span> *user, <span class="number">5</span>)</span><br><span class="line">	c &lt;- g</span><br><span class="line">	fmt.Println(g)</span><br><span class="line">	<span class="comment">// modify g</span></span><br><span class="line">	g = &amp;user&#123;name: <span class="string">&quot;Ankur Anand&quot;</span>, age: <span class="number">100</span>&#125;</span><br><span class="line">	<span class="keyword">go</span> printUser(c)</span><br><span class="line">	<span class="keyword">go</span> modifyUser(g)</span><br><span class="line">	time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line">	fmt.Println(g)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœï¼š</p>
<pre><code>&amp;&#123;Ankur 25&#125;
modifyUser Received Vaule &amp;&#123;Ankur Anand 100&#125;
printUser goRoutine called &amp;&#123;Ankur 25&#125;
&amp;&#123;Anand 100&#125;
</code></pre>
<h2 id="channel-å¦‚ä½•ä¼˜é›…å…³é—­é€šé“"><a href="#channel-å¦‚ä½•ä¼˜é›…å…³é—­é€šé“" class="headerlink" title="channel å¦‚ä½•ä¼˜é›…å…³é—­é€šé“"></a>channel å¦‚ä½•ä¼˜é›…å…³é—­é€šé“</h2><p>æœ‰ä¸¤ä¸ªä¸é‚£ä¹ˆä¼˜é›…åœ°å…³é—­ channel çš„æ–¹æ³•ï¼š</p>
<ul>
<li>ä½¿ç”¨ defer-recover æœºåˆ¶ï¼Œæ”¾å¿ƒå¤§èƒ†åœ°å…³é—­ channel æˆ–è€…å‘ channel å‘é€æ•°æ®ã€‚å³ä½¿å‘ç”Ÿäº† panicï¼Œæœ‰ defer-recover åœ¨å…œåº•ã€‚</li>
<li>ä½¿ç”¨ sync.Once æ¥ä¿è¯åªå…³é—­ä¸€æ¬¡ã€‚</li>
</ul>
<p>é‚£åˆ°åº•åº”è¯¥å¦‚ä½•ä¼˜é›…åœ°å…³é—­ channelï¼Ÿ<br>æ ¹æ® sender å’Œ receiver çš„ä¸ªæ•°ï¼Œåˆ†ä¸‹é¢å‡ ç§æƒ…å†µï¼š</p>
<ol>
<li>ä¸€ä¸ª senderï¼Œä¸€ä¸ª receiver</li>
<li>ä¸€ä¸ª senderï¼Œ M ä¸ª receiver</li>
<li>N ä¸ª senderï¼Œä¸€ä¸ª reciver</li>
<li>N ä¸ª senderï¼Œ M ä¸ª receiver</li>
</ol>
<p>å¯¹äº 1ï¼Œ2ï¼Œåªæœ‰ä¸€ä¸ª sender çš„æƒ…å†µå°±ä¸ç”¨è¯´äº†ï¼Œç›´æ¥ä» sender ç«¯å…³é—­å°±å¥½äº†ï¼Œæ²¡æœ‰é—®é¢˜ã€‚é‡ç‚¹å…³æ³¨ç¬¬ 3ï¼Œ4 ç§æƒ…å†µã€‚</p>
<p>ç¬¬ 3 ç§æƒ…å½¢ä¸‹ï¼Œä¼˜é›…å…³é—­ channel çš„æ–¹æ³•æ˜¯ï¼šthe only receiver says â€œplease stop sending moreâ€ by closing an additional signal channelã€‚</p>
<p>è§£å†³æ–¹æ¡ˆå°±æ˜¯å¢åŠ ä¸€ä¸ªä¼ é€’å…³é—­ä¿¡å·çš„ channelï¼Œreceiver é€šè¿‡ä¿¡å· channel ä¸‹è¾¾å…³é—­æ•°æ® channel æŒ‡ä»¤ã€‚senders ç›‘å¬åˆ°å…³é—­ä¿¡å·åï¼Œåœæ­¢æ¥æ”¶æ•°æ®ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    rand.Seed(time.Now().UnixNano())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> Max = <span class="number">100000</span></span><br><span class="line">    <span class="keyword">const</span> NumSenders = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">    dataCh := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">    stopCh := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// senders</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; NumSenders; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line">                <span class="keyword">select</span> &#123;</span><br><span class="line">                <span class="keyword">case</span> &lt;- stopCh:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">case</span> dataCh &lt;- rand.Intn(Max):</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// the receiver</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">for</span> value := <span class="keyword">range</span> dataCh &#123;</span><br><span class="line">            <span class="keyword">if</span> value == Max<span class="number">-1</span> &#123;</span><br><span class="line">                fmt.Println(<span class="string">&quot;send stop signal to senders.&quot;</span>)</span><br><span class="line">                <span class="built_in">close</span>(stopCh)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            fmt.Println(value)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;- time.After(time.Hour):</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œçš„ stopCh å°±æ˜¯ä¿¡å· channelï¼Œå®ƒæœ¬èº«åªæœ‰ä¸€ä¸ª senderï¼Œå› æ­¤å¯ä»¥ç›´æ¥å…³é—­å®ƒã€‚senders æ”¶åˆ°äº†å…³é—­ä¿¡å·åï¼Œselect åˆ†æ”¯ â€œcase &lt;- stopChâ€ è¢«é€‰ä¸­ï¼Œé€€å‡ºå‡½æ•°ï¼Œä¸å†å‘é€æ•°æ®ã€‚<br>éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰æ˜ç¡®å…³é—­ dataChã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œå¯¹äºä¸€ä¸ª channelï¼Œå¦‚æœæœ€ç»ˆæ²¡æœ‰ä»»ä½• goroutine å¼•ç”¨å®ƒï¼Œä¸ç®¡ channel æœ‰æ²¡æœ‰è¢«å…³é—­ï¼Œæœ€ç»ˆéƒ½ä¼šè¢« gc å›æ”¶ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œæ‰€è°“çš„ä¼˜é›…åœ°å…³é—­ channel å°±æ˜¯ä¸å…³é—­ channelï¼Œè®© gc ä»£åŠ³ã€‚</p>
<p>æœ€åä¸€ç§æƒ…å†µï¼Œä¼˜é›…å…³é—­ channel çš„æ–¹æ³•æ˜¯ï¼šany one of them says â€œletâ€™s end the gameâ€ by notifying a moderator to close an additional signal channelã€‚<br>å’Œç¬¬ 3 ç§æƒ…å†µä¸åŒï¼Œè¿™é‡Œæœ‰ M ä¸ª receiverï¼Œå¦‚æœç›´æ¥è¿˜æ˜¯é‡‡å–ç¬¬ 3 ç§è§£å†³æ–¹æ¡ˆï¼Œç”± receiver ç›´æ¥å…³é—­ stopCh çš„è¯ï¼Œå°±ä¼šé‡å¤å…³é—­ä¸€ä¸ª channelï¼Œå¯¼è‡´ panicã€‚å› æ­¤éœ€è¦å¢åŠ ä¸€ä¸ªä¸­é—´äººï¼ŒM ä¸ª receiver éƒ½å‘å®ƒå‘é€å…³é—­ dataCh çš„â€œè¯·æ±‚â€ï¼Œä¸­é—´äººæ”¶åˆ°ç¬¬ä¸€ä¸ªè¯·æ±‚åï¼Œå°±ä¼šç›´æ¥ä¸‹è¾¾å…³é—­ dataCh çš„æŒ‡ä»¤ï¼ˆé€šè¿‡å…³é—­ stopChï¼Œè¿™æ—¶å°±ä¸ä¼šå‘ç”Ÿé‡å¤å…³é—­çš„æƒ…å†µï¼Œå› ä¸º stopCh çš„å‘é€æ–¹åªæœ‰ä¸­é—´äººä¸€ä¸ªï¼‰ã€‚å¦å¤–ï¼Œè¿™é‡Œçš„ N ä¸ª sender ä¹Ÿå¯ä»¥å‘ä¸­é—´äººå‘é€å…³é—­ dataCh çš„è¯·æ±‚ã€‚</p>
<figure class="highlight go"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    rand.Seed(time.Now().UnixNano())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> Max = <span class="number">100000</span></span><br><span class="line">    <span class="keyword">const</span> NumReceivers = <span class="number">10</span></span><br><span class="line">    <span class="keyword">const</span> NumSenders = <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">    dataCh := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">int</span>, <span class="number">100</span>)</span><br><span class="line">    stopCh := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// It must be a buffered channel.</span></span><br><span class="line">    toStop := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="type">string</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> stoppedBy <span class="type">string</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// moderator</span></span><br><span class="line">    <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">        stoppedBy = &lt;-toStop</span><br><span class="line">        <span class="built_in">close</span>(stopCh)</span><br><span class="line">    &#125;()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// senders</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; NumSenders; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line">                value := rand.Intn(Max)</span><br><span class="line">                <span class="keyword">if</span> value == <span class="number">0</span> &#123;</span><br><span class="line">                    <span class="keyword">select</span> &#123;</span><br><span class="line">                    <span class="keyword">case</span> toStop &lt;- <span class="string">&quot;sender#&quot;</span> + id:</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">select</span> &#123;</span><br><span class="line">                <span class="keyword">case</span> &lt;- stopCh:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">case</span> dataCh &lt;- value:</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;(strconv.Itoa(i))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// receivers</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; NumReceivers; i++ &#123;</span><br><span class="line">        <span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">(id <span class="type">string</span>)</span></span> &#123;</span><br><span class="line">            <span class="keyword">for</span> &#123;</span><br><span class="line">                <span class="keyword">select</span> &#123;</span><br><span class="line">                <span class="keyword">case</span> &lt;- stopCh:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="keyword">case</span> value := &lt;-dataCh:</span><br><span class="line">                    <span class="keyword">if</span> value == Max<span class="number">-1</span> &#123;</span><br><span class="line">                        <span class="keyword">select</span> &#123;</span><br><span class="line">                        <span class="keyword">case</span> toStop &lt;- <span class="string">&quot;receiver#&quot;</span> + id:</span><br><span class="line">                        <span class="keyword">default</span>:</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    fmt.Println(value)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;(strconv.Itoa(i))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">select</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> &lt;- time.After(time.Hour):</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»£ç é‡Œ toStop å°±æ˜¯ä¸­é—´äººçš„è§’è‰²ï¼Œä½¿ç”¨å®ƒæ¥æ¥æ”¶ senders å’Œ receivers å‘é€è¿‡æ¥çš„å…³é—­ dataCh è¯·æ±‚ã€‚<br>è¿™é‡Œå°† toStop å£°æ˜æˆäº†ä¸€ä¸ª ç¼“å†²å‹çš„ channelã€‚å‡è®¾ toStop å£°æ˜çš„æ˜¯ä¸€ä¸ªéç¼“å†²å‹çš„ channelï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªå‘é€çš„å…³é—­ dataCh è¯·æ±‚å¯èƒ½ä¼šä¸¢å¤±ã€‚å› ä¸ºæ— è®ºæ˜¯ sender è¿˜æ˜¯ receiver éƒ½æ˜¯é€šè¿‡ select è¯­å¥æ¥å‘é€è¯·æ±‚ï¼Œå¦‚æœä¸­é—´äººæ‰€åœ¨çš„ goroutine æ²¡æœ‰å‡†å¤‡å¥½ï¼Œé‚£ select è¯­å¥å°±ä¸ä¼šé€‰ä¸­ï¼Œç›´æ¥èµ° default é€‰é¡¹ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚è¿™æ ·ï¼Œç¬¬ä¸€ä¸ªå…³é—­ dataCh çš„è¯·æ±‚å°±ä¼šä¸¢å¤±ã€‚</p>
<p>æ›´æœ¬è´¨çš„åŸåˆ™ï¼š</p>
<blockquote>
<p>donâ€™t close (or send values to) closed channels.</p>
</blockquote>
<h2 id="channel-åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•èµ·èµ„æºæ³„æ¼"><a href="#channel-åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•èµ·èµ„æºæ³„æ¼" class="headerlink" title="channel åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•èµ·èµ„æºæ³„æ¼"></a>channel åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¼•èµ·èµ„æºæ³„æ¼</h2><p>Channel å¯èƒ½ä¼šå¼•å‘ goroutine æ³„æ¼ã€‚<br>æ³„æ¼çš„åŸå› æ˜¯ goroutine æ“ä½œ channel åï¼Œå¤„äºå‘é€æˆ–æ¥æ”¶é˜»å¡çŠ¶æ€ï¼Œè€Œ channel å¤„äºæ»¡æˆ–ç©ºçš„çŠ¶æ€ï¼Œä¸€ç›´å¾—ä¸åˆ°æ”¹å˜ã€‚åŒæ—¶ï¼Œåƒåœ¾å›æ”¶å™¨ä¹Ÿä¸ä¼šå›æ”¶æ­¤ç±»èµ„æºï¼Œè¿›è€Œå¯¼è‡´ gouroutine ä¼šä¸€ç›´å¤„äºç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œä¸è§å¤©æ—¥ã€‚<br>å¦å¤–ï¼Œç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¸€ä¸ª channelï¼Œå¦‚æœæ²¡æœ‰ä»»ä½• goroutine å¼•ç”¨äº†ï¼Œgc ä¼šå¯¹å…¶è¿›è¡Œå›æ”¶æ“ä½œï¼Œä¸ä¼šå¼•èµ·å†…å­˜æ³„æ¼ã€‚</p>
<h2 id="æ“ä½œ-channel-çš„æƒ…å†µæ€»ç»“"><a href="#æ“ä½œ-channel-çš„æƒ…å†µæ€»ç»“" class="headerlink" title="æ“ä½œ channel çš„æƒ…å†µæ€»ç»“"></a>æ“ä½œ channel çš„æƒ…å†µæ€»ç»“</h2><p>æ€»ç»“ä¸€ä¸‹æ“ä½œ channel çš„ç»“æœï¼š</p>
<ol>
<li>ç»™ä¸€ä¸ª nil channel å‘é€æ•°æ®ï¼Œé€ æˆæ°¸è¿œé˜»å¡ </li>
<li>ä»ä¸€ä¸ª nil channel æ¥æ”¶æ•°æ®ï¼Œé€ æˆæ°¸è¿œé˜»å¡ </li>
<li>ç»™ä¸€ä¸ªå·²ç»å…³é—­çš„ channel å‘é€æ•°æ®ï¼Œå¼•èµ· panic </li>
<li>ä»ä¸€ä¸ªå·²ç»å…³é—­çš„ channel æ¥æ”¶æ•°æ®ï¼Œå¦‚æœç¼“å†²åŒºä¸­ä¸ºç©ºï¼Œåˆ™è¿”å›ä¸€ä¸ªé›¶å€¼ </li>
<li>æ— ç¼“å†²çš„channelæ˜¯åŒæ­¥çš„ï¼Œè€Œæœ‰ç¼“å†²çš„channelæ˜¯éåŒæ­¥çš„</li>
</ol>
<p>ä»¥ä¸Š5ä¸ªç‰¹æ€§æ˜¯æ­»ä¸œè¥¿ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å£è¯€æ¥è®°å¿†ï¼š<strong>â€œç©ºè¯»å†™é˜»å¡ï¼Œå†™å…³é—­å¼‚å¸¸ï¼Œè¯»å…³é—­ç©ºé›¶â€</strong>ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œå‘ç”Ÿ panic çš„æƒ…å†µæœ‰ä¸‰ç§ï¼š</p>
<ol>
<li>å‘ä¸€ä¸ªå…³é—­çš„ channel è¿›è¡Œå†™æ“ä½œï¼›</li>
<li>å…³é—­ä¸€ä¸ª nil çš„ channelï¼›</li>
<li>é‡å¤å…³é—­ä¸€ä¸ª channelã€‚</li>
</ol>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a target="_blank" rel="noopener" href="https://qcrao91.gitbook.io/go/channel">ç å†œæ¡ƒèŠ±æº-channel</a><br><a target="_blank" rel="noopener" href="https://www.yuque.com/aceld/golang/ahkkr1">Golangä¿®å…»ä¹‹è·¯-channel</a></p>
</div>
          <nav class="post-nav">
    
    
    <a class="post-nav-item post-nav-next" href="/2023/03/18/Golang-%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/">
      <div class="nav-arrow">OLDER&nbsp;&gt;</div>
      <span class="post-title">Golang-åƒåœ¾å›æ”¶</span>
    </a>
    
  </nav>
          <div class="dis">
    
        <div class="btn" id="comments-btn">ç»™æˆ‘ç•™è¨€</div>
      
     
    <script src='//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js'></script>
    <div id="waline"></div>
    <script>
        window.onload = function () {
            var loadWaline = function () {
                new Waline({
                el: '#waline',
                path: location.pathname,
                avatarCDN: '',
                serverURL: 'comment-vercel.ch3nnn.cn',
                avatar: 'monsterid',
                placeholder: "Let me know what you thinkï¼"
            });
            }
            if (true) {
                document.getElementById("comments-btn").onclick=function(){
                    document.getElementById("comments-btn").style.display="none";
                    loadWaline();
		    }} else {
            loadWaline();
            }
        };
    </script>


  </div>

   </main>
</div>

  <footer class="footer">
    <small class="footer_copyright">
      <div id="bottom-inner">
        Â© 2021 Site by Ch3nnn using
        <a target="_blank" rel="noopener" href="http://hexo.io">Hexo Blog Framework</a>.
        <br>
        <span> Theme is <a target="_blank" rel="noopener" href="https://github.com/dewjohn/hexo-theme-klise">Klise</a></span>
        |
        <span id="busuanzi_container_site_pv">
          Total view <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> times
        </span>
      </div>
      <!-- å¤‡æ¡ˆä¸»ä½“-->
      <a href="https://beian.miit.gov.cn/" rel="nofollow" target="_blank">
            <p style=" height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">
                äº¬ICPå¤‡19017311å·
            </p>
        </a>
    </small>
  </footer>

  

    
      <script src="/js/main.js"></script>
    
  
  <script>
    window.FPConfig = {
      delay: 0,
      ignoreKeywords: [],
      maxRPS: 3,
      hoverDelay: 50,
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>
  <!-- ä¸è’œå­è®¡æ•°å™¨ http://busuanzi.ibruce.info/  -->
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</body>
</html>
